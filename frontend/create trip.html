<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Create Trip - GlobeTrotter</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0d7ff2",
                        "background-light": "#f5f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 antialiased overflow-x-hidden">
    <div class="relative flex h-auto min-h-screen w-full flex-col">
        <header
            class="sticky top-0 z-50 flex items-center justify-between whitespace-nowrap border-b border-solid border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md px-10 py-3">
            <div class="flex items-center gap-4">
                <div class="size-8 text-primary">
                    <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z">
                        </path>
                    </svg>
                </div>
                <h2 class="text-slate-900 dark:text-white text-lg font-bold leading-tight tracking-tight">GlobeTrotter
                </h2>
            </div>
            <div class="flex flex-1 justify-end gap-8">
                <div class="hidden md:flex items-center gap-2">
                    <a class="text-primary bg-primary/10 rounded-lg px-3 py-2 transition-colors text-sm font-semibold leading-normal"
                        href="dashboard.html">Dashboard</a>
                    <a class="text-slate-600 dark:text-slate-300 hover:text-primary hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg px-3 py-2 transition-colors text-sm font-semibold leading-normal"
                        href="dashboard.html">My Trips</a>
                    <a class="text-slate-600 dark:text-slate-300 hover:text-primary hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg px-3 py-2 transition-colors text-sm font-semibold leading-normal"
                        href="budget%20summary.html">Budget</a>
                    <a class="text-slate-600 dark:text-slate-300 hover:text-primary hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg px-3 py-2 transition-colors text-sm font-semibold leading-normal"
                        href="itinerary.html">Itinerary</a>
                </div>
                <div class="flex items-center gap-3 pl-4 border-l border-slate-200 dark:border-slate-700">
                    <button class="relative p-2 text-slate-500 hover:text-primary transition-colors">
                        <span class="material-symbols-outlined text-2xl">notifications</span>
                        <span
                            class="absolute top-2 right-2 size-2 bg-red-500 rounded-full border border-white dark:border-slate-900"></span>
                    </button>
                    <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-9 border-2 border-slate-100 dark:border-slate-700 cursor-pointer ring-2 ring-transparent hover:ring-primary/20 transition-all"
                        data-alt="User profile avatar showing a smiling person"
                        style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDyHvp4MNU9h2Ln5U7ln4-b07odgaaUT0i51iFtyh6SNxiUfJJOZMkEGsxr5jXA8wTpHksqdcL-FzQfCUHYrVB85X_ey7UX4zEgcWhsEm6jhA5xUD0egJwySOmytcgdcZXGIJJGlKPp_EZds3DxzbfNfmIC8mniwF7U3QQKptVdGmsqeM1V02PCTIxCVLhfu1cBEW3xr5o0qs9w4CUrkd-Ds-qOYf1bXuzcgCeyEIjBdlVKwCuDXrv5WG7FYa2VGZKW-EZgtMXRlEg");'>
                    </div>
                </div>
            </div>
        </header>
        <main class="flex-1 flex justify-center py-10 px-4 sm:px-6 md:px-10">
            <div class="flex flex-col max-w-[960px] w-full gap-8">
                <nav class="flex flex-wrap gap-2 text-sm items-center">
                    <a class="text-slate-500 dark:text-slate-400 hover:text-primary transition-colors flex items-center gap-1"
                        href="#">
                        <span class="material-symbols-outlined text-[18px]">home</span>
                    </a>
                    <span
                        class="text-slate-300 dark:text-slate-600 material-symbols-outlined text-[16px]">chevron_right</span>
                    <a class="text-slate-500 dark:text-slate-400 hover:text-primary transition-colors font-medium"
                        href="#">Trips</a>
                    <span
                        class="text-slate-300 dark:text-slate-600 material-symbols-outlined text-[16px]">chevron_right</span>
                    <span
                        class="text-primary font-semibold bg-primary/5 px-2 py-0.5 rounded text-xs uppercase tracking-wide">New
                        Trip</span>
                </nav>
                <div class="flex flex-col gap-3 pb-4 border-b border-slate-200 dark:border-slate-800">
                    <h1
                        class="text-slate-900 dark:text-white text-3xl md:text-4xl font-extrabold leading-tight tracking-tight">
                        Let's plan your next adventure</h1>
                    <p class="text-slate-500 dark:text-slate-400 text-base md:text-lg max-w-2xl">Create a detailed
                        multi-city itinerary. Add stops, choose travel modes, and set dates to manage your journey
                        seamlessly.</p>
                </div>
                <div
                    class="bg-white dark:bg-slate-800 rounded-xl p-6 md:p-8 shadow-sm border border-slate-200 dark:border-slate-700 relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-primary"></div>
                    <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-6 flex items-center gap-3">
                        <div class="size-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary">
                            <span class="material-symbols-outlined text-xl">edit_calendar</span>
                        </div>
                        Trip Overview
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="md:col-span-2">
                            <label class="flex flex-col gap-2">
                                <span class="text-slate-700 dark:text-slate-300 font-semibold text-sm">Trip Name</span>
                                <input
                                    class="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white h-12 px-4 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all placeholder:text-slate-400"
                                    placeholder="e.g., Summer in Italy" type="text" />
                            </label>
                        </div>
                        <div>
                            <label class="flex flex-col gap-2">
                                <span class="text-slate-700 dark:text-slate-300 font-semibold text-sm">Start Date</span>
                                <input
                                    class="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white h-12 px-4 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all placeholder:text-slate-400"
                                    type="date" />
                            </label>
                        </div>
                        <div>
                            <label class="flex flex-col gap-2">
                                <span class="text-slate-700 dark:text-slate-300 font-semibold text-sm">End Date</span>
                                <input
                                    class="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white h-12 px-4 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all placeholder:text-slate-400"
                                    type="date" />
                            </label>
                        </div>
                    </div>
                </div>
                <div class="flex flex-col gap-6">
                    <div
                        class="flex items-center justify-between sticky top-20 z-30 bg-background-light dark:bg-background-dark py-2">
                        <h2 class="text-xl font-bold text-slate-900 dark:text-white flex items-center gap-3">
                            <div class="size-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary">
                                <span class="material-symbols-outlined text-xl">map</span>
                            </div>
                            Itinerary Stops
                        </h2>
                        <span
                            class="text-xs font-semibold bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 px-3 py-1 rounded-full">2
                            stops added</span>
                    </div>
                    <div class="relative pl-4 md:pl-0">
                        <div class="group flex gap-4 md:gap-6 relative pb-10">
                            <div class="flex flex-col items-center absolute -left-5 md:static h-full">
                                <div
                                    class="size-8 rounded-full bg-primary text-white flex items-center justify-center font-bold text-sm shadow-md shadow-primary/20 z-10 ring-4 ring-background-light dark:ring-background-dark">
                                    1</div>
                                <div
                                    class="w-0.5 bg-slate-200 dark:bg-slate-700 h-full -my-2 group-last:bg-transparent">
                                </div>
                            </div>
                            <div
                                class="flex-1 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm p-5 md:p-6 transition-all hover:shadow-md hover:border-primary/40 group/card">
                                <div
                                    class="flex justify-between items-start mb-6 pb-4 border-b border-slate-100 dark:border-slate-700">
                                    <h3
                                        class="font-bold text-lg text-slate-900 dark:text-white flex items-center gap-2">
                                        <span class="material-symbols-outlined text-primary">location_city</span>
                                        Stop 1
                                    </h3>
                                    <button
                                        class="text-slate-400 hover:text-red-500 transition-colors p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 group-hover/card:bg-slate-50 dark:group-hover/card:bg-slate-700">
                                        <span class="material-symbols-outlined text-xl">delete</span>
                                    </button>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                    <div class="md:col-span-2">
                                        <label
                                            class="block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">City
                                            Name</label>
                                        <div class="relative group/input">
                                            <span
                                                class="material-symbols-outlined absolute left-3 top-3 text-slate-400 group-focus-within/input:text-primary transition-colors">location_on</span>
                                            <input
                                                class="w-full pl-10 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900/50 text-slate-900 dark:text-white h-11 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium"
                                                type="text" value="Paris, France" />
                                        </div>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Travel
                                            Mode to here</label>
                                        <div class="grid grid-cols-3 gap-2">
                                            <button
                                                class="flex flex-col items-center justify-center gap-1 p-2 rounded-lg border border-primary bg-primary/5 text-primary transition-all shadow-sm"
                                                type="button">
                                                <span class="material-symbols-outlined text-xl">flight</span>
                                                <span class="text-[10px] font-bold uppercase">Flight</span>
                                            </button>
                                            <button
                                                class="flex flex-col items-center justify-center gap-1 p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all opacity-70 hover:opacity-100"
                                                type="button">
                                                <span class="material-symbols-outlined text-xl">train</span>
                                                <span class="text-[10px] font-bold uppercase">Train</span>
                                            </button>
                                            <button
                                                class="flex flex-col items-center justify-center gap-1 p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all opacity-70 hover:opacity-100"
                                                type="button">
                                                <span class="material-symbols-outlined text-xl">directions_bus</span>
                                                <span class="text-[10px] font-bold uppercase">Bus</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Stay
                                            Duration</label>
                                        <div class="relative group/input">
                                            <input
                                                class="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900/50 text-slate-900 dark:text-white h-11 px-4 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium"
                                                type="number" value="3" />
                                            <span
                                                class="absolute right-4 top-3 text-slate-400 text-xs font-semibold uppercase">Days</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="group flex gap-4 md:gap-6 relative pb-10">
                            <div class="flex flex-col items-center absolute -left-5 md:static h-full">
                                <div
                                    class="size-8 rounded-full bg-white dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 text-slate-500 dark:text-slate-400 flex items-center justify-center font-bold text-sm shadow-sm z-10 ring-4 ring-background-light dark:ring-background-dark">
                                    2</div>
                                <div
                                    class="w-0.5 bg-slate-200 dark:bg-slate-700 h-full -my-2 group-last:bg-transparent">
                                </div>
                            </div>
                            <div
                                class="flex-1 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm p-5 md:p-6 transition-all hover:shadow-md hover:border-primary/40 group/card">
                                <div
                                    class="flex justify-between items-start mb-6 pb-4 border-b border-slate-100 dark:border-slate-700">
                                    <h3
                                        class="font-bold text-lg text-slate-900 dark:text-white flex items-center gap-2">
                                        <span class="material-symbols-outlined text-slate-400">location_city</span>
                                        Stop 2
                                    </h3>
                                    <button
                                        class="text-slate-400 hover:text-red-500 transition-colors p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 group-hover/card:bg-slate-50 dark:group-hover/card:bg-slate-700">
                                        <span class="material-symbols-outlined text-xl">delete</span>
                                    </button>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                    <div class="md:col-span-2">
                                        <label
                                            class="block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">City
                                            Name</label>
                                        <div class="relative group/input">
                                            <span
                                                class="material-symbols-outlined absolute left-3 top-3 text-slate-400 group-focus-within/input:text-primary transition-colors">location_on</span>
                                            <input
                                                class="w-full pl-10 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900/50 text-slate-900 dark:text-white h-11 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium"
                                                placeholder="Enter city name..." type="text" />
                                        </div>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Travel
                                            Mode to here</label>
                                        <div class="grid grid-cols-3 gap-2">
                                            <button
                                                class="flex flex-col items-center justify-center gap-1 p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all hover:border-primary hover:text-primary"
                                                type="button">
                                                <span class="material-symbols-outlined text-xl">flight</span>
                                                <span class="text-[10px] font-bold uppercase">Flight</span>
                                            </button>
                                            <button
                                                class="flex flex-col items-center justify-center gap-1 p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all hover:border-primary hover:text-primary"
                                                type="button">
                                                <span class="material-symbols-outlined text-xl">train</span>
                                                <span class="text-[10px] font-bold uppercase">Train</span>
                                            </button>
                                            <button
                                                class="flex flex-col items-center justify-center gap-1 p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 transition-all hover:border-primary hover:text-primary"
                                                type="button">
                                                <span class="material-symbols-outlined text-xl">directions_bus</span>
                                                <span class="text-[10px] font-bold uppercase">Bus</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div>
                                        <label
                                            class="block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Stay
                                            Duration</label>
                                        <div class="relative group/input">
                                            <input
                                                class="w-full rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900/50 text-slate-900 dark:text-white h-11 px-4 focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium"
                                                placeholder="0" type="number" />
                                            <span
                                                class="absolute right-4 top-3 text-slate-400 text-xs font-semibold uppercase">Days</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex gap-4 md:gap-6 relative">
                            <div class="flex flex-col items-center absolute -left-5 md:static h-full w-8">
                                <div class="w-0.5 border-l-2 border-dashed border-slate-300 dark:border-slate-600 h-10">
                                </div>
                            </div>
                            <button
                                class="flex-1 flex items-center justify-center gap-2 py-4 rounded-xl border-2 border-dashed border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 bg-transparent hover:bg-slate-50 dark:hover:bg-slate-800 hover:border-primary hover:text-primary transition-all font-bold group">
                                <div
                                    class="bg-slate-200 dark:bg-slate-700 rounded-full p-1 group-hover:bg-primary group-hover:text-white transition-colors">
                                    <span class="material-symbols-outlined text-xl">add</span>
                                </div>
                                Add Another Stop
                            </button>
                        </div>
                    </div>
                </div>
                <div
                    class="sticky bottom-0 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm py-6 border-t border-slate-200 dark:border-slate-800 mt-4 flex items-center justify-end gap-4 z-40">
                    <button
                        class="px-6 py-3 rounded-lg text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-800 font-bold text-sm uppercase tracking-wide transition-colors">
                        Cancel
                    </button>
                    <button
                        class="px-8 py-3 rounded-lg bg-primary hover:bg-blue-600 text-white font-bold text-sm uppercase tracking-wide shadow-lg shadow-primary/30 hover:shadow-primary/50 transition-all flex items-center gap-2 transform active:scale-95">
                        <span class="material-symbols-outlined text-lg">check</span>
                        Create Itinerary
                    </button>
                </div>
            </div>
        </main>
    </div>
    <script>
        // ============= API HELPER =============
        const API_BASE = 'http://localhost:5000/api';

        async function apiRequest(endpoint, options = {}) {
            const res = await fetch(API_BASE + endpoint, {
                headers: { 'Content-Type': 'application/json' },
                ...options
            });
            return res.json();
        }

        function showToast(message, type) {
            document.querySelectorAll('.toast').forEach(t => t.remove());
            const colors = { success: '#22c55e', error: '#ef4444', warning: '#f59e0b' };
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.cssText = `position:fixed;bottom:20px;right:20px;background:${colors[type] || colors.success};color:white;padding:12px 24px;border-radius:8px;z-index:9999;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,0.15);`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // ============= STOP MANAGEMENT =============
        let stopCount = 2;

        function deleteStop(btn) {
            const card = btn.closest('.group.flex.gap-4');
            const allCards = document.querySelectorAll('.group.flex.gap-4.relative.pb-10');

            if (allCards.length <= 1) {
                showToast('Cannot delete the last stop!', 'warning');
                return;
            }

            card.style.opacity = '0';
            card.style.transform = 'translateX(-50px)';
            card.style.transition = 'all 0.3s ease';

            setTimeout(() => {
                card.remove();
                updateNumbers();
                showToast('Stop removed', 'success');
            }, 300);
        }

        function updateNumbers() {
            const cards = document.querySelectorAll('.group.flex.gap-4.relative.pb-10');
            cards.forEach((card, i) => {
                const badge = card.querySelector('.size-8.rounded-full');
                if (badge) badge.textContent = i + 1;
                const title = card.querySelector('h3');
                if (title) {
                    const icon = title.querySelector('span');
                    title.innerHTML = '';
                    if (icon) title.appendChild(icon);
                    title.append(' Stop ' + (i + 1));
                }
            });
            const counter = document.querySelector('.bg-slate-200.text-slate-600');
            if (counter) counter.textContent = cards.length + ' stops added';
            stopCount = cards.length;
        }

        function selectMode(btn) {
            const container = btn.closest('.grid.grid-cols-3');
            container.querySelectorAll('button').forEach(b => {
                b.classList.remove('border-primary', 'bg-primary/5', 'text-primary');
                b.classList.add('border-slate-200', 'text-slate-500');
            });
            btn.classList.remove('border-slate-200', 'text-slate-500');
            btn.classList.add('border-primary', 'bg-primary/5', 'text-primary');
        }

        function addStop() {
            stopCount++;
            const container = document.querySelector('.relative.pl-4');
            const addBtn = container.querySelector('.flex.gap-4.relative:not(.pb-10)');

            const html = `
        <div class="group flex gap-4 md:gap-6 relative pb-10">
          <div class="flex flex-col items-center absolute -left-5 md:static h-full">
            <div class="size-8 rounded-full bg-white border-2 border-slate-300 text-slate-500 flex items-center justify-center font-bold text-sm z-10 ring-4 ring-[#f5f7f8]">${stopCount}</div>
            <div class="w-0.5 bg-slate-200 h-full -my-2"></div>
          </div>
          <div class="flex-1 bg-white rounded-xl border border-slate-200 shadow-sm p-5 md:p-6">
            <div class="flex justify-between items-start mb-6 pb-4 border-b border-slate-100">
              <h3 class="font-bold text-lg text-slate-900 flex items-center gap-2">
                <span class="material-symbols-outlined text-slate-400">location_city</span>
                Stop ${stopCount}
              </h3>
              <button onclick="deleteStop(this)" class="text-slate-400 hover:text-red-500 p-2 rounded-lg hover:bg-red-50">
                <span class="material-symbols-outlined text-xl">delete</span>
              </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
              <div class="md:col-span-2">
                <label class="block text-xs font-bold uppercase text-slate-500 mb-2">City Name</label>
                <div class="relative">
                  <span class="material-symbols-outlined absolute left-3 top-3 text-slate-400">location_on</span>
                  <input class="city-input w-full pl-10 rounded-lg border border-slate-300 bg-slate-50 text-slate-900 h-11" placeholder="Enter city name..." type="text"/>
                </div>
              </div>
              <div>
                <label class="block text-xs font-bold uppercase text-slate-500 mb-2">Travel Mode</label>
                <div class="grid grid-cols-3 gap-2">
                  <button onclick="selectMode(this)" type="button" data-mode="flight" class="flex flex-col items-center gap-1 p-2 rounded-lg border border-slate-200 text-slate-500 hover:border-primary hover:text-primary">
                    <span class="material-symbols-outlined text-xl">flight</span>
                    <span class="text-[10px] font-bold">FLIGHT</span>
                  </button>
                  <button onclick="selectMode(this)" type="button" data-mode="train" class="flex flex-col items-center gap-1 p-2 rounded-lg border border-primary bg-primary/5 text-primary">
                    <span class="material-symbols-outlined text-xl">train</span>
                    <span class="text-[10px] font-bold">TRAIN</span>
                  </button>
                  <button onclick="selectMode(this)" type="button" data-mode="bus" class="flex flex-col items-center gap-1 p-2 rounded-lg border border-slate-200 text-slate-500 hover:border-primary hover:text-primary">
                    <span class="material-symbols-outlined text-xl">directions_bus</span>
                    <span class="text-[10px] font-bold">BUS</span>
                  </button>
                </div>
              </div>
              <div>
                <label class="block text-xs font-bold uppercase text-slate-500 mb-2">Stay Duration</label>
                <div class="relative">
                  <input class="days-input w-full rounded-lg border border-slate-300 bg-slate-50 text-slate-900 h-11 px-4" type="number" value="2" min="1"/>
                  <span class="absolute right-4 top-3 text-slate-400 text-xs font-bold">DAYS</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;

            addBtn.insertAdjacentHTML('beforebegin', html);
            updateNumbers();
            showToast('Stop added!', 'success');

            const newCard = addBtn.previousElementSibling;
            newCard.querySelector('.city-input').focus();
        }

        function getStops() {
            const cards = document.querySelectorAll('.group.flex.gap-4.relative.pb-10');
            const stops = [];

            cards.forEach(card => {
                const cityInput = card.querySelector('input[type="text"]');
                const daysInput = card.querySelector('input[type="number"]');
                const selectedMode = card.querySelector('.border-primary[data-mode]') || card.querySelector('button.border-primary');

                const city = cityInput ? cityInput.value.trim() : '';
                if (city) {
                    let mode = 'train';
                    if (selectedMode) {
                        const icon = selectedMode.querySelector('.material-symbols-outlined');
                        if (icon) {
                            if (icon.textContent === 'flight') mode = 'flight';
                            else if (icon.textContent === 'directions_bus') mode = 'bus';
                            else mode = 'train';
                        }
                    }

                    stops.push({
                        city: city,
                        mode: mode,
                        stay_days: parseInt(daysInput?.value) || 1
                    });
                }
            });

            return stops;
        }

        async function createTrip() {
            const tripName = document.querySelector('input[placeholder*="Summer"]')?.value?.trim();
            const dates = document.querySelectorAll('input[type="date"]');
            const startDate = dates[0]?.value || null;
            const endDate = dates[1]?.value || null;
            const stops = getStops();

            if (!tripName) {
                showToast('Please enter a trip name!', 'error');
                return;
            }

            if (stops.length === 0) {
                showToast('Please add at least one city!', 'error');
                return;
            }

            try {
                showToast('Creating trip...', 'success');

                // Create trip
                const trip = await apiRequest('/trip', {
                    method: 'POST',
                    body: JSON.stringify({ name: tripName, start_date: startDate, end_date: endDate })
                });

                console.log('Trip created:', trip);

                // Add stops
                for (const stop of stops) {
                    await apiRequest('/trip/' + trip.id + '/stops', {
                        method: 'POST',
                        body: JSON.stringify(stop)
                    });
                }

                showToast('Trip created successfully!', 'success');
                localStorage.setItem('currentTripId', trip.id);

                setTimeout(() => {
                    window.location.href = 'itinerary.html';
                }, 1500);

            } catch (err) {
                console.error(err);
                showToast('Error: ' + err.message, 'error');
            }
        }

        function goBack() {
            if (confirm('Discard this trip?')) {
                window.location.href = 'dashboard.html';
            }
        }

        // ============= INITIALIZE =============
        document.addEventListener('DOMContentLoaded', function () {
            console.log('ðŸš€ GlobeTrotter Create Trip Loaded');

            // Attach delete handlers to existing stops
            document.querySelectorAll('.group.flex.gap-4.relative.pb-10').forEach(card => {
                const delBtn = card.querySelector('button');
                if (delBtn && delBtn.querySelector('span')?.textContent === 'delete') {
                    delBtn.onclick = function () { deleteStop(this); };
                }

                // Mode buttons
                card.querySelectorAll('.grid.grid-cols-3 button').forEach(btn => {
                    btn.onclick = function (e) { e.preventDefault(); selectMode(this); };
                });
            });

            // Add Stop button
            const addBtns = document.querySelectorAll('button');
            addBtns.forEach(btn => {
                if (btn.textContent.includes('Add Another Stop')) {
                    btn.onclick = function (e) { e.preventDefault(); addStop(); };
                }
                if (btn.textContent.trim() === 'Cancel') {
                    btn.onclick = function (e) { e.preventDefault(); goBack(); };
                }
                if (btn.textContent.includes('Create Itinerary')) {
                    btn.onclick = function (e) { e.preventDefault(); createTrip(); };
                }
            });

            showToast('Ready to create your trip!', 'success');
        });
    </script>
</body>

</html>